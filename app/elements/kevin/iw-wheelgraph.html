<dom-module id="iw-wheelgraph">


<template>
    <div class="iw-content">
        <div class="center horizontal layout">
            <div>Step</div>
            <paper-slider id="iw-step-slider" class="blue" value="67" max="180" step=".5" editable></paper-slider>
            <div>Multiplier</div>
            <paper-slider id="iw-theta-x-slider" class="blue" value="2" max="20" step=".5" editable></paper-slider>
        </div>
        <div id="[[tag]]"></div>
    </div>
</template>


<script>
    Polymer({
        is: 'iw-wheelgraph',


        stage: null,
        wheel: null,

        listeners: {
            'iw-step-slider.immediate-value-change'    : 'stepSliderChanged',
            'iw-step-slider.change'                    : 'stepSliderChanged',
            'iw-theta-x-slider.immediate-value-change' : 'thetaXSliderChanged',
            'iw-theta-x-slider.change'                 : 'thetaXSliderChanged'
        },

        stepSliderChanged: function(event) {
            var newValue = event.currentTarget.immediateValue;

            this.wheel.attrs.step = newValue;
            this.stage.draw();

        },

        thetaXSliderChanged: function(event) {
            var newValue = event.currentTarget.immediateValue;

            this.wheel.attrs.thetaX = newValue;
            this.stage.draw();

        },

        attached: function() {

            var width = 440; // window.innerWidth;
            var height = 440; //window.innerHeight - 25;

            // first we need Konva core things: stage and layer
            this.stage = new Konva.Stage({
                container : this.tag, //'iw-container-',
                width     : width,
                height    : height
            });

            var layer = new Konva.Layer({
                draggable    : true
            });
            this.stage.add(layer);


//            // then we are going to draw into special canvas element
//            var canvas = document.createElement('canvas');
//            canvas.width  = stage.width()  / 2;
//            canvas.height = stage.height() / 2;

            this.wheel = new IWheel({
                fill        : 'blue',
                stroke      : 'red',
                strokeWidth :   0.5,
                x           : 235,
                y           : 200,
                zoom        : 150,
                step        : 57,
                thetaX      : 2,
                exp         : 1
            });
            layer.add(this.wheel);


            this.stage.draw();
        }

//    var angularSpeed = 80;
//    var anim = new Konva.Animation(function(frame) {
//        var angleDiff = frame.timeDiff * angularSpeed / 1000;
////        wedge.rotate(angleDiff);
//        wheel.rotate(angleDiff);
//    }, layer);
//
//    anim.start();




//    var randomButton = document.getElementById('random');
//    randomButton.addEventListener('click', function() {
//        wheel.roll();
//        stage.draw();
    });

</script>

</dom-module>
